{% extends "layout.html" %}

{% block title%}
News
{% endblock %}

{% block banner%}
static/images/newsbanner.jpg
{% endblock %}

{% block content%}

<!--suppress HtmlUnknownTarget -->
<div class="news-box">
    <div class="news-text">

        <div class="container-lg py-sm-5 py-1">
            <h1>What do you need to know?</h1>

            {% if session['auth'] == 0 %}
                <div class="news p-4 my-4 text-end">
                    <a class="btn btn-primary" href="{{ url_for('news_cud', id=0, task='add') }}">Add News</a>
                </div>
            {% endif %}

            {% for row in news %}
                <div class="news p-4 my-4">
                    <h2> {{ row['title'] }} </h2>
                    <div class="news-meta"> Posted by {{ row['first_name'] }} on {{ row['newsdate'] | news_date }} </div>
                    <p class="subtitle"> {{ row['subtitle'] }} </p>
                    <p class="news-text"> {{ row['content'] | replace("\n", "<br>") | safe}} </p>

                    <div class="news-meta">
                        {% if session['auth'] == 0 %}
                            <a class="btn btn-primary" href="{{ url_for('news_cud', id=row['news_id'], task='update') }}">Update</a>
                            <a class="btn btn-primary" href="{{ url_for('news_cud', id=row['news_id'], task='delete') }}">Delete</a>
                        {% endif %}
                        {% if session %}
                            <a class="btn btn-primary" href="{{ url_for('news_cud', id=row['news_id'], task='comment') }}">Comment</a>
                        {% endif %}
                    </div>

                    {% for comms in comments %}
                        {% if comms['news_tag_id'] == row['news_id'] %}
                            <p class="news-meta"> Comment by {{ comms['first_name'] }} on {{ comms['comment_date'] | news_date }}</p>
                            <p class="news-text"> {{ comms['comment'] }}</p>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}

        </div>
    </div>
</div>

{% endblock %}